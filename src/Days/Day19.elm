module Days.Day19 exposing (getPuzzleAnswer, getPuzzleAnswer2)

import Array exposing (..)
import Char exposing (..)


type Direction
    = Down
    | Right
    | Left
    | Up


getPuzzleInput : String
getPuzzleInput =
    """
               |
             +---------------------------------------------------+                 +-+         +-----+       +-------------------------------+     +-------------------------------------+         +---+
             | |                                                 |                 | |         |     |       |                               |     |                                     |         |   |
             | |         +-----+     +---------------------------|-------------------|---------+     |       |                               |     |                             +-----+ |         |   |
             | |         |     |     |                           |                 | |               |       |                               |     |                             |     | |         |   |
             +---+ +-+   |     +---+ +-----------------------------+               | +---------------+       |                         +-----------|-----------------------------|---+ +-+     +---|-+ |
               | | | |   |         |                             | |               |                         |                         |     |     |                             |   |         |   | | |
               | | +-|---+ +---+ +-|-----------------------------|-|-------------------------------------------------------+           |     |     +-------------------------------------------|---|-+ |
               | |   |     |   | | |                             | |               |                         |             |           |     |                                   |   |         |   |   |
             +---|-+ |   +-|---|-----------------------------------|-----------------------------+           +-------------|-----------|-------------------------------------------------------|-----+ |
             | | | | |   | |   | | |                             | |               |             |                         |           |     |                                   |   |         |   | | |
             | | | | |   | |   | | |             +---+   +-+     | +---------------|-----------------------------------------------+   |     |                                   |   |         |   | | |
             | | | | |   | |   | | |             |   |   | |     |                 |             |                         |       |   |     |                                   |   |         |   | | |
             +---|-|-----|-|---|-|---+           |   |   | |     | +---------------|--------------------------------P--------------|-------------------------------------------------------+   |   | | |
               | | | |   | |   | | | |           |   O   | |     | |               |             |                         |       |   |     |                                   |   |     |   |   | | |
               | | | |   | |   | | | +-----------|-------|-----------------------------------------------------------------------------------------------------------------+     |   |     |   |   | | |
               | | | |   | |   | | |             |   |   | |     | |               |             |                         |       |   |     |                             |     |   |     |   |   | | |
   +-------+   | | | |   | | +---|-|---+       +-|---+   | |     | |               |             |                         |       |   |     |                             |     |   |     |   |   | | |
   |       |   | | | |   | | | | | |   |       | |       | |     | |               |             |                         |       |   |     |                             |     |   |     |   |   | | |
   |       |   | | | |   | | | | | |   |       | |       | |     | |               |             |                         |       |   |   +-------------------+           |     |   |   +-+   |   | | |
   |       |   | | | |   | | | | | |   |       | |       | |     | |               |             |                         |       |   |   | |                 |           |     |   |   |     |   | | |
   |     +-+   | +-------|-----|-|-|---|-------------------|-----|-|-----------------------------|-------------------------|-------|---------------------------|-----------------|---|---|-+   |   | | |
   |     |     |   | |   | | | | | |   |       | |       | |     | |               |             |                         |       |   |   | |                 |           |     |   |   | |   |   | | |
   |     +-----|---|-----|-----|---|-----------|-+   +---|-|-----|-----------------|-----------------------------------------------|-------|-|-------------------------+   |   +-|---|---|-+   |   | | |
   |           |   | |   | | | M | |   |       |     |   | |     | |               |             |                         |       |   |   | |                 |       |   |   | |   |   |     |   | | |
 +-|-+     +-+ | +---|---+ | | | +---------+   |     |   | |     | |               |             |                         |       |   |   | | +---------------------+ |   |   | |   |   |     |   | | |
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |               |             |                         |       |   |   | | |               |     | |   |   | |   |   |     |   | | |
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |               |             |                         |       |   |   | | |               |     | |   |   | |   |   |     |   | | |
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |               |             |                         |       |   |   | | |               |     | |   |   | |   |   |     |   | | |
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |   +-----------|-------------|---------------------------------|-----------|-----+         | +-------------|-|-------+     |   | | |
 | | |     | | | | | |     | | |   |   |   |   |     |   | |     | |   |           |             |                         |       |   |   | | |     |         | |   | |   |   | |   |         |   | | |
 | | |     | +-|-----------|-|-|---|---|----------------S--|-----|-------------------------------|-----------------+       |       |   |   | +-------------------+   | |   |   | | +-|L----+   |   | | |
 | | |     |   | | | |     | | |   |   |   |   |     |   | |     | |   |           |             |                 |       |       |   |   |   |     |         |     | |   |   | | | |     |   |   | | |
 | | |     |   | | | |     | | | +-|-----------|-----------|-----|-----|-----------|-+           |                 |       |       +---|---|-----------+       |     | |   |   | | | |     |   |   | | |
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | |
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | |
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | |
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | |
 | | |     |   | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       |           |   |   |     | |       |     | |   |   | | | |     |   |   | | |
 | | |     +-+ | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |       +-----------|---|---------|-|-------|-----|-|-------|-|-+ |     |   |   | | |
 | | |       | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |     | |   |   | |   |     |   |   | | |
 +-|-|-------|-------------|-----|-|-------|---------------------|-------------------|-----------|---------------------------------------------------|-|-------|-----+ |   |   | |   |     +---+   | | |
   | |       | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |             | | |
   | +-+     | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |             | | |
   |   |     | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |             | | |
   |   |     | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |         +-+ | | |
   |   |     | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           |                 |                   |   |   |     | |       |       |   |   | |   |         | | | | |
   |   | +-----|-+ +-|-----|---|-|---------|---|---------|-|-----------|-----------|-|-----------|-+               |       +---+       |   |   | +-------------|---------+ |   | |   |         | | | | |
   |   | |   | |     |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |   |       |   |   | |   | |       |       | | |   | |   |         | | | | |
   |   | |   | |     |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |   +-----------------|---|---------|---+   | | |   | |   |         | | | | |
   |   | |   | |     |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |           |   |   | |   | |       |   |   | | |   | |   |         | | | | |
   |   | |   | | +-+ |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |           |   |   | |   | |       |   |   | | |   | |   |         | | | | |
   |   | |   | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           | |               |       |           |   |   | |   | |       |   |   | | |   | |   |         | | | | |
   |   | |   | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           | |           +---|-------|-----------|---+   | |   | |       |   |   | | |   | |   |         | | | | |
   |   | |   | | | | |     | | | | |   |   |   |     |   | |     | |   |           | |           | |           |   |       |           |       | |   | |       |   |   | | |   | |   |         | | | | |
   |   | |   | | | | |     | | | | |   |   |   | +-----+ | |     | |   |           | |           | |     +---------|-------------------|---------|---|-|-------|---|-----|-------|---------+   | | | | |
   |   | |   | | | | |     | | | | |   |   |   | |   | | | |     | |   |           | |           | |     |     |   |       |           |       | |   | |       |   |   | | |   | |   |     |   | | | | |
   +---|-----|-----|-------|---|---+   |   |   | |   | | | |     | |   +-----+     | |           | |     |     |   +-------------------|-------|-|-----|-------|---|-----|-|---------------|-+ | | | | |
       | |   | | | | |     | | | |     |   |   | |   | | | |     | |         |     | |           | |     |     |           |           |       | |   | |       |   |   | | |   | |   |     | | | | | | |
       | |   | | | | |     | | | |     |   |   | |   | | | |     | |         |     | |           | |     |     |           |           |       | |   | |       |   |   | | |   | |   |     | | | | | | |
       | |   | | | | |     | | | |     |   |   | |   | | | |     | |         |     | |           | |     |     |           |           |       | |   | |       |   |   | | |   | |   |     | | | | | | |
     +---|---|-|-----|-----|-----+     |   |   | |   | | | |     | |   +-----|-----|-------------|-|-----------------------|-----------|-+     | |   | |       |   |   | | |   | |   |   +-|---+ | | | |
     | | |   | | | | |     | | |       |   |   | |   | | | |     | |   |     |     | |           | |     |     |           |           | |     | |   | |       |   |   | | |   | |   |   | | |   | | | |
   +---------------|---------|---------|---------|---+ | | | +-----|---------------|-------------|-|-----------|-----------|-----------+ |   +-+ |   | |       |   | +-----|-----|---|-------------+ | |
   | | | |   | | | | |     | | |       |   |   | |     | | | |   | |   |     |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | |   |   | |
   | | | |   +-|-|---|-----|---|-+     |   |   | |     | | | |   | |   |   +-|-------|-------------|-----------|-----------|---------------------------|-------|---|-----|-|-----|---|---------+ |   | |
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | | | |   | |
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | +-|---+ | |
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | |   | | | | |
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | +-+ | | | |
   | | | |     | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |     |     |           |             |   |   |   | |       |   | | | | |   | |   |   | | |   | | | |
   | | | |   +-|-|---|-----|-----------|-------|-------|---|-----------------|-----|-|-------------------+     |           |             |   |   |   | |       |   | | | | |   | |   |   | | |   | | | |
   | | | |   | | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |   | |       |   | | | | |   | |   |   | | |   | | | |
   | | | |   | | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |   +-|-------+   | | | | |   | |   |   | | |   | | | |
   | | | |   | | | | |     | | | |     |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |     |           | | | | |   | |   |   | | |   | | | |
   | | | |   | | | | |     | | | +-----|---|---|-------|-|---------|-----------------+           | |           |           |             |   |   |     |     +-+   | | | | |   | |   |   | | +-----+ | |
   | | | |   | | | | |     | | |       |   |   | |     | | | |   | |   |   | |     |             | |           |           |             |   |   |     |     | |   | | | | |   | |   |   | |     |   | |
   | | | |   | | | | +-+   | | |       |   |   | |     | | | |   | |   |   | |     | +-----------|-------------------------------------------------------------|-----|-|-|-|-----|---|-----|----A|-+ | |
   | | | |   | | | |   |   | | |       |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |     |     | |   | | | | |   | |   |   | |     | | | |
   | | | |   | | | |   |   | | |       |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |     |     | |   | | | | |   | |   |   | |     | | | |
   | | | |   | | | |   |   | | |       |   |   | |     | | | |   | |   |   | |     | |           | |           |           |             |   |   |     |     | |   | | | | |   | |   |   | |     | | | |
   | | | |   | | | |   |   +---|-----+ |   |   | |     | | | |   | |   |   | |     | |           +-|-----------|-------------------------|-------|-----------------------|-|-------------|-+     | | | |
   | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |   |     |     | |   | | | | |   | |   |   |       | | | |
   | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |   |     |     | |   | | | | |   | |   |   |       | | | |
   | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |   |     |     | |   | | | | |   | |   |   |       | | | |
 +---|-|-|---|-----|---|-------|-----|-----|-----|-----|---|-|---|-----------------|-|-----------------------------------------------------------+     |     | |   | | | | |   | |   |   |       | | | |
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | |
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | |
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | |
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | |
 | | | | |   | | | |   |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |           |           |             |   |         |     | |   | | | | |   | |   |   |       | | | |
 | | | | |   | | | | +---------------------------|-----|---|-|-----|---|---|-------|-|-------------------------+           |             |   |         |     | |   | | | | |   | |   |   |       | | | |
 | | | | |   | | | | | |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |                       |             |   |         |     | |   | | | | |   | |   |   |       | | | |
 | | +-|-|---|---------------|-|-----------|-----|-------|---|---------|-----------|---------------------------------------------------------|---------|-----|-------|-+ | |   | |   |   |       | | | |
 | |   | |   | | | | | |     | |     | |   |   | |     | | | |   | |   |   | |     | |             |                       |             |   |         |     | |   | |   | |   | |   |   |       | | | |
 | +-----|---+ | | +-|---+   | | +---|-|---|-+ | |     | | | |   | |   |   | |     | |     +-------|-------------------------------------|---|---------------|-|---|-|---------|-|---|---|-------|-|-|-+
 |     | |     | |   | | |   | | |   | |   | | | |     | | | |   | |   |   | |     | |     |       |                       |             |   |         |     | |   | |   | |   | |   |   |       | | |
 | +---|---+ +-+ +---|-|-|---|-|-----|-----|---|-----------|-|---|-----|-+ | |     | |     |       |           +-------------------------|-------------|-----|-|---|-----------------|---|-------|-|-+
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   | | | |     | |     |       |           |           |             |   |         |     | |   | |   | |   | |   |   |       | |
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   | +---|---------------------|-------------------------------------|-------------------|-|---|-------|-+ | |   |   |       | |
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   |   | |     | |     |       |           |           |             |   |         |     | |   | |   | | | | |   |   |       | |
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   | +-----------|-------------|-------------------------------------|---|-----------------|-----|---|---|-|-----|---|-------|-----+
 | |   | | | |       | | |   | | |   | |   | | | |     | | | |   | |   | | | |     | |     |       |           |           |             |   |         |     | |   | |   | | | | |   |   |       | |   |
 | |   | | | |       | | | +-----|---|-|-----|-|-|-----|---|-----|-------|---------------------+   |           |           |             |   |         |     | |   | |   | | | | |   |   |       | |   |
 | |   | | | |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |       | |   |
 | |   | | +-----------------|---------|---------|-------|-|-|---|-|---------|-----|-|---------|---|-----------|-----------|-----------------|---------|-------|---|-----|---|-|-|---|-------+   | |   |
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |   | |   |
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |   +---+ |
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |     | | |
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |     | | |
 | |   | |   |       | | | | | | |   | |   | | | |     | | | |   | |   | | | |     | |     |   |   |           |           |             |   |         |     | |   | |   | | | | |   |   |   |     | | |
 | +---|-|---|---------|-|-|---|-----|-----------|-------+ | |   | |   | | | |     | |     |   +---|-----------------------|---------------------------|-----|-----|-|---|-+ | | |   |   |   |     | | |
 |     | |   |       | | | | | | |   | |   | | | |     |   | |   | |   | | | |     | |     |       |           |           |             |   |         |     | |   | |   |   | | |   |   |   |     | | |
 |     | | +-----------+ | | | | |   | |   | | | |     |   | |   | |   | | | |     +-|-----|-------------------|---------+ |             |   |         |     | |   | |   |   | | |   |   |   |     | | |
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | |       |     |       |           |         | |             |   |         |     | |   | |   |   | | |   |   |   |     | | |
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | | +-----------|---------------------------------------------|---|---------|-----------|-----+   | | |   |   | +-|-----|---+
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | | |     |     |       |           |         | |             |   |         |     | |   | |       | | |   |   | | |     | |
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | | |     |     |       |           | +-------|---------------|-------------+     | |   | |       | | |   |   | | |     | |
 |     | | | |       |   | | | | |   | |   | | | |     |   | |   | |   | | | | |     |     |       |           | |       | |             |   |               | |   | |       | | |   |   | | |     | |
 |     | | | |       |   | | | | |   | |   +-|-------+ |   | |   | |   | | | | |     |   +-|-------|-----------|-----------|-------------|-------------------|-|-----|-----------|-------|-------+ | |
 |     | | | |       |   | | | | |   | |     | | |   | |   | |   | |   | | | | |     |   | |       |           | |       | |             |   |               | |   | |       | | |   |   | | |   | | |
 |     | | | |       |   | | | | |   | |     | | |   | +---+ +---|-----|-|---|-+ +---|---|-|-----+ |           | +---------|-------------|---------+         | |   | |       | | |   |   | | |   | | |
 |     | | | |       |   | | | | |   | |     | | |   |           | |   | | | |   |   |   | |     | |           |         | |             |   |     |         | |   | |       | | |   |   | | |   | | |
 |     | | | |       |   | +-|-+ |   | |     | | |   +-----------|-|-----|---|-------|---|-|-------|---------------------+ |             |   |     |     +---|-------|-+     | | |   |   | | |   | | |
 |     | | | |       |   |   |   |   | |     | | |               | |   | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |     | | |   |   | | |   | | |
 |     | | | |   +---+ +-|---|-+ |   | |     | | |   +-----------|---+ | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |   +-|-----------------------|-+
 |     | | | |   |     | |   | | |   | |     | | |   |           | | | | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |   | | | |   |   | | |   | | | |
 |     | | | |   +---------+ | +-------|-----|-+ |   |           | | | | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |   | | | |   |   | | |   | | | |
 |     | | | |         | | | |   |   | |     |   |   |           | | | | | | |   |   |   | |     | |           |           |             |   |     |     |   | |   | | |   | | | |   |   | | |   | | | |
 | +-----|-|-------------|-|-|---|---|-------|-------|-+         | | | | | | |   |   |   | | +-----+         +---+         |             |   +-+   |     |   | |   | | |   | +-------------|-+   | | | |
 | |   | | | |         | | | |   |   | |     |   |   | |         | | | | | | |   |   |   | | |   |           | | |         |             |     |   |     |   | |   | | |   |   | |   |   | |     | | | |
 | |   | | +-|---------|---|-|---|---|-|-----|---------|---------------|-|-----+ | +-|---+ | | +-------------|-------------|-------------|-------------------|-----|-+ +---|-+ | |   |   | |     | | | |
 | |   | |   |         | | | |   |   | |     |   |   | |         | | | | | | | | | | |     | | | |           | | |         |             |     |   |     |   | |   |       | | | |   |   | |     | | | |
 | |   | |   |         | | | |   |   | |     |   |   | |         | | | | | | | | | | |     | | | |           | | +---------|-----------------------|-----|---|-|---|---+   | | | |   |   | |     | | | |
 | |   | |   |         | | | |   |   | |     |   |   | |         | | | | | | | | | | |     | | | |           | |           |             |     |   |     |   | |   |   |   | | | |   |   | |     | | | |
 | |   | |   |         | | | |   |   | |     |   |   | +-----------+ | | | | | | | | |     | | | |           | |         +---------------------|---|---------|-|-------------|-|---------|-|-----+ | | Y
 | |   | |   |         | | | |   |   | |     |   |   |           |   | | | | | | | | |     | | | |           | |         | |             |     |   |     |   | |   |   |   | | | |   |   | |       | |
 | |   | |   |         | | | |   |   | |     |   |   +---------------|---|-|-----|-----------|-----------------|---------|---------------------|---|-----|-----|---|-------|-+ | |   |   | +-----+ | |
 | |   | |   |         | | | |   |   | |     |   |               |   | | | | | | | | |     | | | |           | |         | |             |     |   |     |   | |   |   |   |   | |   |   |       | | |
 | |   | | +-----------|-|-----+ |   | |     |   +---------------------|-|-|---+ | +---------------------------|---------|---------------|---------------------------------------------------------|-|-+
 | |   | | | |         | | | | | |   | |     |                   |   | | | | |   |   |     | | | |           | |         | |             |     G   |     |   | |   |   |   |   | |   |   |       | | | |
 | |   | +---|---------|---|---|-------|---------------------------------------------|-----|---|-|-----------------------|-|-------------|-----|---------|---|-------+ |   | +-------------+     | | | |
 | |   |   | |         | | | | | |   | |     |                   |   | | | | |   |   |     | | | |           | |         | |             |     |   |     |   | |   | | |   | | | |   |   | |     | | | |
 | |   |   | |         | | | | | |   | |     |                   |   | | | | |   |   |     | | | |           | |         | |       +-----|---------|-----+   | |   | +-|-----+ | |   |   | |     | | | |
 | |   |   | |         | | | | | |   | |     |                   |   | | | | |   |   |     | | | |           | |         | |       |     |     |   |         | |   |   |   |   | |   |   | |     | | | |
 | | +-|---+ |         +-|---|-------|-|-------------------------------|-|---|---|---|---+ | | | |           | |         | |       |     |     |   |   +-+   | |   +-------------|---|-------+   | | | |
 | | | |     |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |         | |       |     |     |   |   | |   | |       |   |   | |   |   | | |   | | | |
 | | | |     |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |     +---|-|---+   | +---|---------|---------------+   |   |   | |   |   | | |   | | | |
 | | | |     |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |     |   | |   |   | |   |     |   |   | |   | |   |   |   |   | |   |   | | |   | | | |
 | | | |   +---------------|-|---------------|-------------------|---|-|-|-|-|---|---|---|-|-|-|-|-------------------+   | |   |   | |   |     |   |   | +---+ |   |   |   | +---|---|-----|-+   | | | |
 | | | |   | |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | |
 | | | |   | |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | |
 | | | |   | |           | | | | |   | |     |                   |   | | | | |   |   |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | |
 | | | |   | |           | | | | |   | |     |     +-------------|---|-|---------|-+ |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | |
 | | | |   | |           | | | | |   | |     |     |             |   | | | | |   | | |   | | | | |           | |         | |   |   | |   |     |   |   |       |   |   |   | | | |   |   | |     | | | |
 +-+ | |   +-------------------|-----|-------|-----|-------------+   | | | | |   | | |   | | | | |           +-----------------|---|-|---+     |   |   |       |   |   |   | | | |   |   | |     | | | |
     | |     |           | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |   |   | |         |   |   |       |   |   |   | | | |   |   | |     | | | |
 +---+ |     |           | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |   +-------------+ |   |   |       |   |   |   | | | |   |   | |     | | | |
 |     |     |           | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |       | |       | |   |   |       |   |   |   | | | |   |   | |     | | | |
 |     |     |     +---+ | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |       | |       | |   |   |       |   |   +-----|-|-|-----+ | | +-------+ |
 |     |     |     |   | | | | | |   | |     |     |                 | | | | |   | | |   | | | | |             |         | |       | |       | |   |   |       |   |       | | | |   | | | | |   | |   |
 +-----|---------+ |   | | +-----|---|-------|-----|-----------------|-|-----------------+ +---|---------------+         | |       | |       | |   |   +-------|---|-------|-|-------|-|---|-+   | |   |
       |     |   | |   | |   | | |   | |     |     |                 | | | | |   | | |       | | |                       | |       | |       | |   |           |   |       | | | |   | | | |     | |   |
       |     |   | |   | |   | | |   +-------------|-------------+   | | | +-|---|-+ |       | | |                       | |       | |       | |   |           |   |   +---+ | | |   | | | | +-+ | |   |
       |     |   | |   | |   | | |     |     |     |             |   | | |   |   |   |       | | J                       | |       | |       | |   |           |   |   |     | | |   | | | | | | | |   |
       |     |   | |   | +-------------|-----------+             |   | | |   |   |   |       | | |                       | |       | |       | +---|---+       |   |   |     | | |   | | | | | | | |   |
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |                       | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   |
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       +---+           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   |
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   |
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   |
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   |
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   |
       |     |   | |   |     | | |     |     |                   |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |   | | | | | | | |   |
       |     |   | |   |     +-+ |     |     |         +---------|---|-|-|-------|---|-------|-|---------|---|---------------------|---------|-----|---------------|-----------|-----+ +---------|-+   |
       |     |   | |   |         |     |     |         |         |   | | |   |   |   |       | | |       |   |           | |       | |       |     |   |       |   |   |     | | |       | | | | |     |
       |     |   | |   |         |     |     |         |         |   | | |   +-------|-------|---|-----+ |   |           +-|-----------------|-----+   +-----------|---|-----|-+ |       | | | | |     |
       |     |   | |   |         |     |     |         |         |   | | |       |   |       | | |     | |   |             |       | |       |                 |   |   |     |   |       | | | | |     |
       +-----|---------|---------+     +-----------------------------+ | |   +---|-+ |       | +-|-----|-----|-------------|---------|-------+                 |   |   |     |   |       | | | | |     |
             |   | |   |                     |         |         |     | |   |   | | |       |   |     | |   |             |       | |                         |   |   |     |   |       | | | | |     |
             |   | |   |                     |         |         |     | |   |   | | |       |   |     | |   |             |       | |                         |   +---+     |   |     +---+ | | | +---+
             |   | |   |                     |         |         |     | |   |   | | |       |   |     | |   |             |       | |                         |             |   |     | |   | | | |
       +---------+ |   |                     |         |         |     | |   |   | | |       |   |     +-|---|-------------|-------|-+                         |             |   |   +-+ |   | +-|---+
       |     |     |   |                     |         |         |     | |   |   | | |       |   |       |   |             |       |                           |             |   |   |   |   |   | | |
       |     |     |   |                     |         |         |     | |   +-------|-------|---------------|-------------|---------+                         |             |   |   |   |   |   | | |
       |     |     |   |                     |         |         |     | |       | | |       |   |       |   |             |       | |                         |             |   |   |   |   |   | | |
       | +---+     |   |                     |         |         +-----|-|-------|-|---------|-----------|-------------------------|-----------------------------------------+ +-+   |   +---|-----|-+
       | |         |   |                     |         |               | |       | | |       |   |       |   |             |       | |                         |               |     |       |   | |
       | +-----------------------------------|---------|---------+     | +-------|---+       |   |       |   |             +-------|---------------------------+         +-----------|-------+   +-+
       |           |   |                     |         |         |     |         | |         |   |       |   |                     | |                                   |     |     |
       |           +-----------------------------------+         |     |     +---+ |         +-----------+ +-----------------------|-------------------------------------------+     +-------+
       |               |                     |                   |     |     |     |             |         | |                     | |                                   |                   |
       |               |                   +---------------------|-----------|-----------------------------|-------------------------|-----------------------------------+                   +-------+
       |               |                   | |                   |     |     |     |             |         | |                     | |                                                               |
 +-----+               +-------------------|---------------------------+ +---------------------------------|-|-----------------------|-----------------------------------------------------+         |
 |                                         | |                   |       |   |     |             |         | |                     | |                                                     |         |
 |                 +-------------------------|-------------------|-------|---|-----+             |         | |                     | |                                                     |         |
 |                 |                       | |                   |       |   |                   |         | |                     | |                                                     |         |
 |                 |                     +---|-------------------|-----------|-----------------------------+ +---------------------+ |                                                     |   +-----+
 |                 |                     | | |                   |       |   |                   |                                   |                                                     |   |
 +-----------------+                     +-+ +-------------------+       +---+                   +-----------------------------------+                                                     +---+
    """


getIndexOfFirstInstruction : Int -> String -> Int
getIndexOfFirstInstruction index row =
    let
        updatedIndex =
            index + 1

        updatedRow =
            String.dropLeft 1 row

        selectedCharacter =
            Tuple.first <|
                Maybe.withDefault ( ' ', "" ) <|
                    String.uncons row
    in
    if String.isEmpty row then
        -1
    else if selectedCharacter /= ' ' then
        index
    else
        getIndexOfFirstInstruction updatedIndex updatedRow


getCharacterFromIndexes : Int -> Int -> Array String -> Char
getCharacterFromIndexes rowIndex columnIndex puzzleRows =
    Tuple.first <|
        Maybe.withDefault ( ' ', "" ) <|
            String.uncons <|
                String.dropLeft (columnIndex - 1) <|
                    Maybe.withDefault "" <|
                        Array.get rowIndex puzzleRows


resolveCrossRoad : ( Int, Int ) -> Direction -> Array String -> Array Char -> ( ( Int, Int ), Direction, Array Char )
resolveCrossRoad ( rowIndex, columnIndex ) direction puzzleRows letters =
    let
        rightCharacter =
            getCharacterFromIndexes rowIndex (columnIndex + 1) puzzleRows

        leftCharacter =
            getCharacterFromIndexes rowIndex (columnIndex - 1) puzzleRows

        bottomCharacter =
            getCharacterFromIndexes (rowIndex + 1) columnIndex puzzleRows

        topCharacter =
            getCharacterFromIndexes (rowIndex - 1) columnIndex puzzleRows

        upAndDownTuple =
            if isUpper rightCharacter || isLower rightCharacter then
                ( ( rowIndex, columnIndex + 2 ), Right, Array.push rightCharacter letters )
            else if rightCharacter /= ' ' then
                ( ( rowIndex, columnIndex + 1 ), Right, letters )
            else if isUpper leftCharacter || isLower leftCharacter then
                ( ( rowIndex, columnIndex - 2 ), Left, Array.push leftCharacter letters )
            else
                ( ( rowIndex, columnIndex - 1 ), Left, letters )

        leftAndRightTuple =
            if isUpper topCharacter || isLower topCharacter then
                ( ( rowIndex - 2, columnIndex ), Up, Array.push topCharacter letters )
            else if topCharacter /= ' ' then
                ( ( rowIndex - 1, columnIndex ), Up, letters )
            else if isUpper bottomCharacter || isLower bottomCharacter then
                ( ( rowIndex + 2, columnIndex ), Down, Array.push bottomCharacter letters )
            else
                ( ( rowIndex + 1, columnIndex ), Down, letters )
    in
    case direction of
        Up ->
            upAndDownTuple

        Down ->
            upAndDownTuple

        Left ->
            leftAndRightTuple

        Right ->
            leftAndRightTuple


gatherLettersFromRoute : Array String -> ( Int, Int ) -> Direction -> Array Char -> Array Char
gatherLettersFromRoute puzzleRows prevIndexes prevDirection letters =
    let
        ( prevRow, prevColumn ) =
            prevIndexes

        previousSelectedCharacter =
            getCharacterFromIndexes prevRow prevColumn puzzleRows

        ( updatedIndexes, updatedDirection, updatedLetters ) =
            case prevDirection of
                Up ->
                    if previousSelectedCharacter == '|' then
                        ( ( prevRow - 1, prevColumn ), Up, letters )
                    else if previousSelectedCharacter == '+' then
                        resolveCrossRoad prevIndexes prevDirection puzzleRows letters
                    else if previousSelectedCharacter == '-' then
                        ( ( prevRow - 1, prevColumn ), Up, letters )
                    else
                        ( ( prevRow - 1, prevColumn ), Up, Array.push previousSelectedCharacter letters )

                Down ->
                    if previousSelectedCharacter == '|' then
                        ( ( prevRow + 1, prevColumn ), Down, letters )
                    else if previousSelectedCharacter == '+' then
                        resolveCrossRoad prevIndexes prevDirection puzzleRows letters
                    else if previousSelectedCharacter == '-' then
                        ( ( prevRow + 1, prevColumn ), Down, letters )
                    else
                        ( ( prevRow + 1, prevColumn ), Down, Array.push previousSelectedCharacter letters )

                Left ->
                    if previousSelectedCharacter == '|' then
                        ( ( prevRow, prevColumn - 1 ), Left, letters )
                    else if previousSelectedCharacter == '+' then
                        resolveCrossRoad prevIndexes prevDirection puzzleRows letters
                    else if previousSelectedCharacter == '-' then
                        ( ( prevRow, prevColumn - 1 ), Left, letters )
                    else
                        ( ( prevRow, prevColumn - 1 ), Left, Array.push previousSelectedCharacter letters )

                Right ->
                    if previousSelectedCharacter == '|' then
                        ( ( prevRow, prevColumn + 1 ), Right, letters )
                    else if previousSelectedCharacter == '+' then
                        resolveCrossRoad prevIndexes prevDirection puzzleRows letters
                    else if previousSelectedCharacter == '-' then
                        ( ( prevRow, prevColumn + 1 ), Right, letters )
                    else
                        ( ( prevRow, prevColumn + 1 ), Right, Array.push previousSelectedCharacter letters )
    in
    if previousSelectedCharacter == ' ' || prevRow < 0 || prevRow > Array.length puzzleRows || prevColumn < 0 || prevColumn > 201 then
        letters
    else
        gatherLettersFromRoute puzzleRows updatedIndexes updatedDirection updatedLetters


getPuzzleAnswer : String
getPuzzleAnswer =
    let
        puzzleRows =
            Array.map (String.padRight 201 ' ') <|
                Array.filter (not << String.isEmpty) <|
                    Array.fromList <|
                        String.lines getPuzzleInput

        exampleInput =
            """
     |
     |  +--+
     A  |  C
 F---|----E|--+
     |  |  |  D
     +B-+  +--+
            """

        examplePuzzleRows =
            Array.map (String.padRight 16 ' ') <|
                Array.filter (not << String.isEmpty) <|
                    Array.fromList <|
                        String.lines exampleInput

        firstRow =
            Maybe.withDefault "" <|
                -- Array.get 0 examplePuzzleRows
                Array.get 0 puzzleRows

        startingIndex =
            getIndexOfFirstInstruction 0 firstRow

        letters =
            -- gatherLettersFromRoute examplePuzzleRows ( 0, startingIndex + 1 ) Down (Array.fromList [])
            gatherLettersFromRoute puzzleRows ( 0, startingIndex + 1 ) Down (Array.fromList [])
    in
    String.fromList (Array.toList letters)


getPuzzleAnswer2 : String
getPuzzleAnswer2 =
    ""
